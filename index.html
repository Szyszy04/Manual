<!DOCTYPE html>
<html lang="pl">
<head>
    <meta author="Wiktor">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Barma≈Ñski</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vue@3.3.4/dist/vue.global.js"></script>
</head>
<body>
    <div id="app">
        <!-- Ekran startowy -->
        <div v-if="currentScreen === 'start'" class="screen">
            <div class="container">
                <h1>üç∏ Quiz Barma≈Ñski</h1>
                <p class="subtitle">Wybierz kategorie i sprawd≈∫ swojƒÖ wiedzƒô o drinkach!</p>

                <!-- Wyb√≥r kategorii alkoholi -->
                <div class="section">
                    <h3>ü•É Kategorie Alkoholi</h3>
                    <p class="help-text">Pytania bƒôdƒÖ dotyczy≈Çy tylko wybranych kategorii</p>
                    <div class="alcohol-categories">
                        <label v-for="(category, index) in Object.keys(selectedAlcoholCategories)" :key="category" :for="'alcohol-' + index" class="category-option">
                            <input type="checkbox" 
                                   :id="'alcohol-' + index" 
                                   v-model="selectedAlcoholCategories[category]">
                            <span class="category-name">
                                <span>{{ getCategoryEmoji(category) }}</span>
                                {{ category }}
                            </span>
                        </label>
                    </div>
                    <div v-if="hasSelectedAlcoholCategories" class="selected-info">
                        ‚úÖ Wybrano: {{ selectedAlcoholCategoriesList.join(', ') }}
                    </div>
                    <div v-else class="warning">
                        ‚ö†Ô∏è Wybierz przynajmniej jednƒÖ kategoriƒô alkoholu!
                    </div>
                </div>

                <!-- Wyb√≥r trybu quizu -->
                <div class="section">
                    <h3>üéØ Tryby Quizu</h3>
                    <div class="quiz-categories">
                        <label for="mode-proportions" class="category-option">
                            <input type="checkbox" id="mode-proportions" v-model="selectedCategories.proportions">
                            <div>
                                <strong>üìä Proporcje</strong>
                                <p class="description">Sprawd≈∫ znajomo≈õƒá proporcji sk≈Çadnik√≥w</p>
                            </div>
                        </label>
                        <label for="mode-review" class="category-option">
                            <input type="checkbox" id="mode-review" v-model="selectedCategories.review">
                            <div>
                                <strong>üîç Sk≈Çadniki</strong>
                                <p class="description">Czy sk≈Çadnik jest w drinku?</p>
                            </div>
                        </label>
                        <label for="mode-vodka" class="category-option">
                            <input type="checkbox" id="mode-vodka" v-model="selectedCategories.vodka">
                            <div>
                                <strong>üçÄ W√≥dka</strong>
                                <p class="description">Pytania o ceny i surowce w√≥dek</p>
                            </div>
                        </label>
                        <label for="mode-builder" class="category-option">
                            <input type="checkbox" id="mode-builder" v-model="selectedCategories.builder">
                            <div>
                                <strong>üîß Builder</strong>
                                <p class="description">Zbuduj drink od podstaw</p>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Przycisk rozpoczƒôcia -->
                <div class="actions">
                    <button @click="startQuiz" :class="['btn', 'btn-primary', { disabled: !hasSelectedCategories || !hasSelectedAlcoholCategories }]" :disabled="!hasSelectedCategories || !hasSelectedAlcoholCategories">
                        üöÄ Rozpocznij Quiz
                    </button>
                </div>

                <!-- Dodatkowe opcje -->
                <div class="secondary-actions">
                    <button @click="goToLibrary" class="btn btn-secondary">üìö Biblioteka Alkoholi</button>
                    <button @click="goToDrinkLibrary" class="btn btn-secondary">üçπ Biblioteka Drink√≥w</button>
                    <button @click="goToIngredientLibrary" class="btn btn-secondary">üß™ Biblioteka Sk≈Çadnik√≥w</button>
                    <button @click="goToDrinkMap" class="btn btn-secondary">üó∫Ô∏è Mapa Drink√≥w</button>
                </div>
            </div>
        </div>

        <!-- Ekran mapy drink√≥w -->
        <div v-if="currentScreen === 'drink-map'" class="screen">
            <div class="container">
                <h1>üó∫Ô∏è Mapa Drink√≥w</h1>
                <p class="subtitle">Podobne drinki pogrupowane wed≈Çug sk≈Çadnik√≥w</p>

                <div class="drink-map-content">
                    <div v-for="(group, groupKey) in drinkGroups" :key="groupKey" class="drink-group">
                        <div class="group-header">
                            <h3>{{ group.icon }} {{ group.name }}</h3>
                            <p class="group-description">{{ group.description }}</p>
                        </div>

                        <div class="drinks-grid">
                            <div v-for="drink in group.drinks" :key="drink.name" class="drink-card">
                                <div class="drink-name">{{ drink.name }}</div>

                                <div class="ingredients-section">
                                    <h5>Sk≈Çadniki wsp√≥lne:</h5>
                                    <div class="ingredients-list common-ingredients">
                                        <span v-for="ingredient in drink.commonIngredients" 
                                              :key="'common-' + ingredient" 
                                              class="ingredient-tag common">
                                            {{ ingredient }}
                                        </span>
                                    </div>

                                    <h5 v-if="drink.uniqueIngredients.length > 0">Sk≈Çadniki unikalne:</h5>
                                    <div v-if="drink.uniqueIngredients.length > 0" class="ingredients-list unique-ingredients">
                                        <span v-for="ingredient in drink.uniqueIngredients" 
                                              :key="'unique-' + ingredient" 
                                              class="ingredient-tag unique">
                                            {{ ingredient }}
                                        </span>
                                    </div>
                                </div>

                                <div class="recipe-section">
                                    <h5>Przepis:</h5>
                                    <div class="recipe-list">
                                        <div v-for="step in drink.recipe" 
                                             :key="step" 
                                             class="recipe-step">
                                            {{ step }}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="actions">
                    <button @click="goToStart" class="btn btn-secondary">‚¨ÖÔ∏è Powr√≥t do Menu</button>
                </div>
            </div>
        </div>

        <!-- Ekran quizu -->
        <div v-if="currentScreen === 'quiz'" class="screen quiz-screen">
            <div class="container">
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" :style="{ width: progressWidth }"></div>
                    </div>
                    <div class="progress-text">Pytanie {{ currentQuestionIndex + 1 }} z {{ questions.length }}</div>
                </div>

                <div class="question-container">
                    <h2 class="question">{{ currentQuestion.question }}</h2>

                    <!-- Zwykle odpowiedzi (TAK/NIE) -->
                    <div v-if="currentQuestion.answers && currentQuestion.answers.length === 2" class="answers-grid simple-answers">
                        <button v-for="(answer, index) in shuffledAnswers" :key="index" @click="answerQuestion(index)" :disabled="answerSelected" :class="['answer-btn', getAnswerClass(index)]">
                            {{ answer }}
                        </button>
                    </div>

                    <!-- Odpowiedzi z recepturami -->
                    <div v-else-if="currentQuestion.answers && currentQuestion.answers.length > 2" class="answers-grid">
                        <button v-for="(answer, index) in shuffledAnswers" :key="index" @click="answerQuestion(index)" :disabled="answerSelected" :class="['answer-btn recipe-option', getAnswerClass(index)]">
                            <div class="recipe">
                                <div v-for="ingredient in answer" :key="ingredient.name" class="ingredient">
                                    <span class="amount">**{{ ingredient.amount }} ml**</span>
                                    <span class="name">{{ ingredient.name }}</span>
                                </div>
                            </div>
                        </button>
                    </div>

                    <!-- Builder Mode -->
                    <div v-if="currentQuestion.type === 'builder'">
                        <!-- Krok 1: Wyb√≥r sk≈Çadnik√≥w -->
                        <div v-if="builderStep === 1" class="builder-step">
                            <h4>Krok 1: Wybierz sk≈Çadniki dla drinka "{{ currentQuestion.drinkName }}"</h4>
                            <p>Wybrane: {{ selectedIngredientsCount }}</p>
                            <div class="ingredients-grid">
                                <button v-for="ingredient in currentQuestion.allIngredients" :key="ingredient" @click="toggleIngredient(ingredient)" :class="['ingredient-btn', { selected: selectedIngredients.has(ingredient) }]">
                                    {{ ingredient }}
                                </button>
                            </div>
                            <button @click="checkIngredients" class="btn btn-primary">Sprawd≈∫ sk≈Çadniki</button>
                        </div>

                        <!-- Krok 2: Proporcje -->
                        <div v-if="builderStep === 2" class="builder-step">
                            <h4>Krok 2: Ustaw proporcje sk≈Çadnik√≥w</h4>
                            <div class="proportions-input">
                                <div v-for="ingredient in Array.from(selectedIngredients)" :key="ingredient" class="proportion-item">
                                    <label>{{ ingredient }}</label>
                                    <input type="number" v-model="ingredientAmounts[ingredient]" placeholder="ml">
                                    <span>ml</span>
                                </div>
                            </div>
                            <button @click="checkProportions" class="btn btn-primary">Sprawd≈∫ proporcje</button>
                        </div>

                        <!-- Krok 3: Szk≈Ço -->
                        <div v-if="builderStep === 3" class="builder-step">
                            <h4>Krok 3: Wybierz odpowiednie szk≈Ço</h4>
                            <div class="glasses-grid">
                                <button v-for="glass in shuffledGlassOptions" :key="glass" @click="selectGlass(glass)" :class="['glass-btn', { selected: selectedGlass === glass }]">
                                    {{ glass }}
                                </button>
                            </div>
                            <button @click="checkGlass" class="btn btn-primary" :disabled="!selectedGlass">Sprawd≈∫ szk≈Ço</button>
                        </div>

                        <!-- Komunikaty -->
                        <div v-if="showBuilderRecipe" class="recipe-reveal error">
                            <h4>B≈Çƒôdna odpowied≈∫!</h4>
                            <div class="correct-recipe">
                                <h4>Poprawna receptura "{{ currentQuestion.drinkName }}":</h4>
                                <div v-for="ingredient in builderCorrectRecipeWithNames" :key="ingredient.name">
                                    <p><strong>{{ ingredient.amount }} ml</strong> {{ ingredient.name }}</p>
                                </div>
                                <p><strong>Szk≈Ço:</strong> {{ currentQuestion.correctGlass }}</p>
                                <p><strong>Dekoracja:</strong> {{ currentQuestion.decoration }}</p>
                            </div>
                        </div>

                        <div v-if="showDecorationSuccess" class="success-message">
                            <h4>Brawo! Poprawnie przygotowa≈Çe≈õ drinka!</h4>
                            <p>+1 punkt!</p>
                        </div>
                    </div>

                    <!-- Pokazanie receptury po odpowiedzi -->
                    <div v-if="showRecipe" class="recipe-reveal">
                        <h4>Receptura "{{ currentQuestion.drinkName }}":</h4>
                        <div v-for="ingredient in currentRecipe" :key="ingredient.name" class="ingredient">
                            <span class="name">{{ ingredient.name }}</span>
                        </div>
                    </div>

                    <!-- Pokazanie poprawnej proporcji -->
                    <div v-if="showProportionsInfo" class="recipe-reveal">
                        <strong>{{ currentQuestion.correctInfo }}</strong>
                    </div>
                </div>

                <div class="score-info">Wynik: {{ score }}/{{ currentQuestionIndex + 1 }}</div>
            </div>
        </div>

        <!-- Ekran wynik√≥w -->
        <div v-if="currentScreen === 'result'" class="screen">
            <div class="container">
                <h1>üèÜ Wyniki Quizu</h1>
                <div class="final-score">
                    <div class="score-circle">
                        <div>
                            <div class="score">{{ score }}</div>
                            <div class="total">{{ questions.length }}</div>
                        </div>
                    </div>
                    <div class="percentage">{{ Math.round((score / questions.length) * 100) }}%</div>
                </div>

                <div class="score-message">
                    <p v-if="score === questions.length">Perfekcyjny wynik!ü•á</p>
                    <p v-else-if="score / questions.length >= 0.8">≈öwietny wynik!ü•à</p>
                    <p v-else-if="score / questions.length >= 0.6">Dobry wynik!ü•â</p>
                    <p v-else> Nie poddawaj siƒô! üí™</p>
                </div>

                <div class="actions">
                    <button @click="restartQuiz" class="btn btn-primary">üîÑ Spr√≥buj ponownie</button>
                </div>
            </div>
        </div>

        <!-- Biblioteka Alkoholi -->
        <div v-if="currentScreen === 'library'" class="screen">
            <div class="container">
                <h1>üìö Biblioteka Alkoholi</h1>

                <div class="library-navigation">
                    <div class="categories-nav">
                        <button v-for="category in libraryCategories" :key="category" @click="selectLibraryCategory(category)" :class="['category-btn', { active: selectedLibraryCategory === category }]">
                            {{ category }}
                        </button>
                    </div>
                </div>

                <div class="library-content">
                    <div v-for="item in currentLibraryItems" :key="item.name" class="library-item">
                        <h3>{{ item.name }}</h3>
                        <p>{{ item.description }}</p>
                    </div>
                </div>

                <div class="actions">
                    <button @click="goToStart" class="btn btn-secondary">‚¨ÖÔ∏è Powr√≥t do menu</button>
                </div>
            </div>
        </div>

        <!-- Biblioteka Drink√≥w -->
        <div v-if="currentScreen === 'drink-library'" class="screen">
            <div class="container">
                <h1>üçπ Biblioteka Drink√≥w</h1>

                <div class="library-navigation">
                    <div class="categories-nav">
                        <button v-for="category in drinkCategories" :key="category" @click="selectDrinkCategory(category)" :class="['category-btn', { active: selectedDrinkCategory === category }]">
                            {{ category }}
                        </button>
                    </div>
                </div>

                <div class="drinks-grid">
                    <div v-for="drink in currentDrinkItems" :key="drink.name" :class="['drink-card', { hidden: isDrinkHidden(drink.name) }]" @click="toggleDrinkVisibility(drink.name)">
                        <h3>{{ drink.name }}</h3>
                        <div class="glass-info">ü•É {{ drink.glass }}</div>

                        <div v-if="!isDrinkHidden(drink.name)" class="drink-details">
                            <div class="ingredients">
                                <h4>Sk≈Çadniki:</h4>
                                <ul>
                                    <li v-for="ingredient in drink.ingredients" :key="ingredient">{{ ingredient }}</li>
                                </ul>
                            </div>

                            <div class="method">
                                <h4>Przygotowanie:</h4>
                                <ol>
                                    <li v-for="step in drink.method" :key="step">{{ step }}</li>
                                </ol>
                            </div>

                            <div v-if="drink.decoration" class="decoration">
                                <h4>Dekoracja:</h4>
                                <p>{{ drink.decoration }}</p>
                            </div>
                        </div>
                        <div v-else class="hidden-state">
                            Kliknij aby pokazaƒá sk≈Çadniki i przepis
                        </div>
                    </div>
                </div>

                <div class="actions">
                    <button @click="goToStart" class="btn btn-secondary">‚¨ÖÔ∏è Powr√≥t do menu</button>
                </div>
            </div>
        </div>

        <!-- Biblioteka Sk≈Çadnik√≥w -->
        <div v-if="currentScreen === 'ingredient-library'" class="screen">
            <div class="container">
                <h1>üß™ Biblioteka Sk≈Çadnik√≥w</h1>

                <div class="library-navigation">
                    <div class="categories-nav">
                        <button v-for="category in ingredientLibraryCategories" :key="category" @click="selectIngredientCategory(category)" :class="['category-btn', { active: selectedIngredientCategory === category }]">
                            {{ category }}
                        </button>
                    </div>
                </div>

                <div class="ingredient-library-content">
                    <div v-for="(details, ingredient) in currentIngredientLibraryItems" :key="ingredient" class="ingredient-category-card">
                        <h3>{{ ingredient }}</h3>
                        <div class="brand-sections">
                            <div class="brand-section">
                                <h4>üìã Manual</h4>
                                <div class="brand-list">
                                    <span v-for="brand in details.manual" :key="brand" class="brand-tag manual">{{ brand }}</span>
                                </div>
                            </div>

                            <div class="brand-section">
                                <h4>üè∑Ô∏è Inne</h4>
                                <div class="brand-list">
                                    <span v-for="brand in details.inne" :key="brand" class="brand-tag other">{{ brand }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="actions">
                    <button @click="goToStart" class="btn btn-secondary">‚¨ÖÔ∏è Powr√≥t do menu</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>
