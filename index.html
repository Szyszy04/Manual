<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Barma≈Ñski</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
    <div id="app">
        <div class="main-card">
            <!-- Ekran startowy -->
            <div v-if="currentScreen === 'start'">
                <h2>üçπ Quiz Barma≈Ñski</h2>

                <div class="main-navigation">
                    <button class="btn main-nav-btn" @click="currentScreen = 'categories'">
                        üéØ Rozpocznij Quiz
                    </button>
                    <button class="btn main-nav-btn library-btn" @click="goToLibrary">
                        üç∑ Biblioteka Alkocholi
                    </button>
                    <button class="btn main-nav-btn drinks-btn" @click="goToDrinkLibrary">
                        üç∏ Biblioteka Drink√≥w
                    </button>
                </div>
            </div>

            <!-- Wyb√≥r kategorii -->
            <div v-if="currentScreen === 'categories'">
                <button class="btn-back" @click="goToStart">‚Üê Powr√≥t</button>
                <h2>Wybierz kategorie pyta≈Ñ:</h2>

                <div class="selector">
                    <label>
                        <input type="checkbox" v-model="selectedCategories.proportions">
                        ‚öñÔ∏è Proporcje sk≈Çadnik√≥w
                    </label>
                    <label>
                        <input type="checkbox" v-model="selectedCategories.review">
                        üîÑ Powt√≥rka sk≈Çadnik√≥w TAK/NIE
                    </label>
                    <label>
                        <input type="checkbox" v-model="selectedCategories.vodka">
                        ü•É W√≥dki (cena/surowiec)
                    </label>
                    <label>
                        <input type="checkbox" v-model="selectedCategories.builder">
                        üîß Konstruktor drinka (sk≈Çadniki + proporcje + szk≈Ço)
                    </label>
                </div>

                <button class="btn" @click="startQuiz" :disabled="!hasSelectedCategories">
                    Rozpocznij Quiz
                </button>
            </div>

            <!-- Biblioteka alkocholi -->
            <div v-if="currentScreen === 'library'">
                <button class="btn-back" @click="goToStart">‚Üê Powr√≥t</button>
                <h2>üç∑ Biblioteka Alkocholi</h2>
                <p class="library-subtitle">Poznaj charakterystyki r√≥≈ºnych alkocholi</p>

                <div class="library-categories">
                    <button 
                        v-for="category in libraryCategories" 
                        :key="category"
                        class="category-btn"
                        :class="{ active: selectedLibraryCategory === category }"
                        @click="selectLibraryCategory(category)"
                    >
                        {{ category }}
                    </button>
                </div>

                <div class="library-content">
                    <div v-for="alcohol in currentLibraryItems" :key="alcohol.name" class="alcohol-card">
                        <h3 class="alcohol-name">{{ alcohol.name }}</h3>
                        <p class="alcohol-description">{{ alcohol.description }}</p>
                    </div>
                </div>
            </div>

            <!-- Biblioteka drink√≥w -->
            <div v-if="currentScreen === 'drink-library'">
                <button class="btn-back" @click="goToStart">‚Üê Powr√≥t</button>
                <h2>üç∏ Biblioteka Drink√≥w</h2>
                <p class="library-subtitle">Przepisy koktajli wed≈Çug alkocholi bazowych</p>

                <div class="library-categories">
                    <button 
                        v-for="category in drinkCategories" 
                        :key="category"
                        class="category-btn"
                        :class="{ active: selectedDrinkCategory === category }"
                        @click="selectDrinkCategory(category)"
                    >
                        {{ category }}
                    </button>
                </div>

                <div class="library-content">
                    <div v-if="currentDrinkItems.length === 0" class="empty-category">
                        <p>Brak drink√≥w w tej kategorii</p>
                        <small>Przepisy bƒôdƒÖ dodane wkr√≥tce</small>
                    </div>

                    <div v-for="drink in currentDrinkItems" :key="drink.name" 
                         class="drink-card" 
                         :class="{ hidden: isDrinkHidden(drink.name) }"
                         @click="toggleDrinkVisibility(drink.name)">
                        <h3 class="drink-name">{{ drink.name }}</h3>

                        <div class="drink-details" :class="{ hidden: isDrinkHidden(drink.name) }">
                            <!-- Szk≈Ço -->
                            <div v-if="drink.glass" class="drink-glass">
                                <h4>ü•É Szk≈Ço:</h4>
                                <p>{{ drink.glass }}</p>
                            </div>

                            <div class="drink-ingredients">
                                <h4>üß™ Sk≈Çadniki:</h4>
                                <ul>
                                    <li v-for="ingredient in drink.ingredients" :key="ingredient">{{ ingredient }}</li>
                                </ul>
                            </div>

                            <!-- Metoda przygotowania -->
                            <div v-if="drink.method && drink.method.length > 0" class="drink-method">
                                <h4>‚öóÔ∏è Metoda:</h4>
                                <ol>
                                    <li v-for="step in drink.method" :key="step">{{ step }}</li>
                                </ol>
                            </div>

                            <div class="drink-decoration">
                                <h4>üé® Dekoracja:</h4>
                                <p>{{ drink.decoration }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quiz -->
            <div v-if="currentScreen === 'quiz'">
                <div class="progress-bar">
                    <div class="progress" :style="{ width: progressWidth }"></div>
                </div>

                <p v-if="questions.length > 0">
                    Pytanie {{ (currentQuestionIndex || 0) + 1 }} / {{ questions.length }}
                </p>

                <!-- Tryb builder - krok 1: wybierz sk≈Çadniki -->
                <div v-if="currentQuestion.type === 'builder' && builderStep === 1">
                    <h3>üîß Konstruktor drinka - Krok 1/3</h3>
                    <p class="builder-instruction">Wybierz sk≈Çadniki dla tego drinka:</p>
                    <h4 class="center" v-if="currentQuestion.drinkName">{{ currentQuestion.drinkName }}</h4>

                    <div class="builder-ingredients" v-if="currentQuestion.allIngredients">
                        <div v-for="ingredient in currentQuestion.allIngredients" 
                             :key="ingredient" 
                             class="ingredient-checkbox"
                             @click="toggleIngredient(ingredient)">
                            <input type="checkbox" 
                                   :checked="selectedIngredients.has(ingredient)"
                                   @click.stop="">
                            <span>{{ ingredient }}</span>
                        </div>
                    </div>

                    <div class="builder-actions">
                        <p class="selected-count">Wybrano: {{ selectedIngredientsCount }}</p>
                        <button class="btn" @click="checkIngredients" :disabled="selectedIngredientsCount === 0">
                            Sprawd≈∫ sk≈Çadniki
                        </button>
                    </div>
                </div>

                <!-- Tryb builder - krok 2: wpisz proporcje -->
                <div v-else-if="currentQuestion.type === 'builder' && builderStep === 2">
                    <h3>üîß Konstruktor drinka - Krok 2/3</h3>
                    <p class="builder-instruction">Wpisz proporcje dla wybranych sk≈Çadnik√≥w:</p>
                    <h4 class="center" v-if="currentQuestion.drinkName">{{ currentQuestion.drinkName }}</h4>

                    <div class="builder-proportions">
                        <div v-for="ingredient in Array.from(selectedIngredients)" 
                             :key="ingredient" 
                             class="proportion-input">
                            <label>{{ ingredient }}:</label>
                            <input type="number" 
                                   v-model="ingredientAmounts[ingredient]" 
                                   placeholder="ml"
                                   min="1">
                            <span>ml</span>
                        </div>
                    </div>

                    <div class="builder-actions">
                        <button class="btn" @click="checkProportions">
                            Sprawd≈∫ proporcje
                        </button>
                    </div>
                </div>

                <!-- Tryb builder - krok 3: wybierz szk≈Ço -->
                <div v-else-if="currentQuestion.type === 'builder' && builderStep === 3">
                    <h3>üîß Konstruktor drinka - Krok 3/3</h3>
                    <p class="builder-instruction">Wybierz odpowiednie szk≈Ço dla tego drinka:</p>
                    <h4 class="center" v-if="currentQuestion.drinkName">{{ currentQuestion.drinkName }}</h4>

                    <div class="builder-glasses">
                        <button v-for="glass in shuffledGlassOptions" 
                                :key="glass"
                                class="glass-btn"
                                :class="{ selected: selectedGlass === glass }"
                                @click="selectGlass(glass)">
                            ü•É {{ glass }}
                        </button>
                    </div>

                    <div class="builder-actions">
                        <p v-if="selectedGlass" class="selected-count">Wybrane szk≈Ço: {{ selectedGlass }}</p>
                        <button class="btn" @click="checkGlass" :disabled="!selectedGlass">
                            Sprawd≈∫ szk≈Ço
                        </button>
                    </div>
                </div>

                <!-- Pytania normalne (nie builder) -->
                <div v-else-if="currentQuestion.type && currentQuestion.type !== 'builder'">
                    <h3 v-if="currentQuestion.question">{{ currentQuestion.question }}</h3>
                    <h3 v-else-if="currentQuestion.type === 'proportions' && currentQuestion.correct">
                        Wybierz poprawne proporcje dla: <strong>{{ currentQuestion.correct }}</strong>
                    </h3>

                    <!-- Odpowiedzi TAK/NIE -->
                    <div v-if="currentQuestion.type === 'review'" class="yn-wrapper">
                        <button v-for="(answer, index) in shuffledAnswers" 
                                :key="index"
                                class="answer-btn yn-btn" 
                                :class="getAnswerClass(index)"
                                @click="answerQuestion(index)"
                                :disabled="answerSelected">
                            {{ answer }}
                        </button>
                    </div>

                    <!-- Odpowiedzi normalne -->
                    <div v-else>
                        <button v-for="(answer, index) in shuffledAnswers" 
                                :key="index"
                                class="answer-btn" 
                                :class="getAnswerClass(index)"
                                @click="answerQuestion(index)"
                                :disabled="answerSelected">

                            <!-- Wy≈õwietlanie proporcji -->
                            <div v-if="currentQuestion.type === 'proportions'" class="recipe-option">
                                <div v-for="ingredient in answer" :key="ingredient.name" class="ingredient">
                                    {{ ingredient.name }}: <strong>{{ ingredient.amount }} ml</strong>
                                </div>
                            </div>

                            <!-- Zwyk≈Çe odpowiedzi tekstowe -->
                            <span v-else>{{ answer }}</span>
                        </button>
                    </div>

                    <!-- Wy≈õwietlanie przepisu po odpowiedzi -->
                    <div v-if="showRecipe" class="recipe-review-box">
                        <h4 v-if="currentQuestion.drinkName">üìã Przepis: {{ currentQuestion.drinkName }}</h4>
                        <ul>
                            <li v-for="ingredient in currentRecipe" :key="ingredient.name">
                                <span>{{ ingredient.name }}</span>
                                <strong>{{ ingredient.amount }} ml</strong>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Wy≈õwietlanie prawid≈Çowego przepisu w trybie builder przy b≈Çƒôdach -->
                <div v-if="showBuilderRecipe && currentQuestion.correctRecipe" class="recipe-review-box">
                    <h4 v-if="currentQuestion.drinkName">üìã Prawid≈Çowy przepis: {{ currentQuestion.drinkName }}</h4>

                    <!-- Sk≈Çadniki -->
                    <div class="correct-answer-section">
                        <h5>üß™ Sk≈Çadniki:</h5>
                        <ul>
                            <li v-for="ingredient in currentQuestion.correctRecipe" :key="ingredient.name">
                                <span>{{ ingredient.name }}</span>
                                <strong>{{ ingredient.amount }} ml</strong>
                            </li>
                        </ul>
                    </div>

                    <!-- Szk≈Ço -->
                    <div v-if="currentQuestion.correctGlass" class="correct-answer-section">
                        <h5>ü•É Szk≈Ço:</h5>
                        <p><strong>{{ currentQuestion.correctGlass }}</strong></p>
                    </div>
                </div>

                <!-- Wy≈õwietlanie dekoracji przy sukcesie -->
                <div v-if="showDecorationSuccess && currentQuestion.decoration" class="decoration-success-box">
                    <h4>üéâ Gratulacje! Drink wykonany prawid≈Çowo!</h4>
                    <div class="decoration-section">
                        <h5>üé® Dekoracja:</h5>
                        <p>{{ currentQuestion.decoration }}</p>
                    </div>
                </div>
            </div>

            <!-- Wyniki -->
            <div v-if="currentScreen === 'result'">
                <h2>üéâ Wyniki</h2>
                <div class="score">{{ score }} / {{ questions.length }}</div>
                <div class="percentage" v-if="questions.length > 0">
                    {{ Math.round((score/questions.length)*100) }}%
                </div>
                <button class="btn" @click="restartQuiz">Spr√≥buj ponownie</button>
            </div>
        </div>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>
