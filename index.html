<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Barma≈Ñski</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- Ekran startowy -->
        <div v-if="currentScreen === 'start'" class="main-card">
            <h2>üçπ Quiz Barma≈Ñski</h2>

            <!-- Nawigacja g≈Ç√≥wna -->
            <div class="main-navigation">
                <button @click="goToLibrary()" class="btn main-nav-btn library-btn">
                    üìö Biblioteka Alkocholi
                </button>
                <button @click="goToDrinkLibrary()" class="btn main-nav-btn drinks-btn">
                    üç∏ Biblioteka Drink√≥w
                </button>
            </div>

            <h3>Wybierz kategorie pyta≈Ñ:</h3>

            <div class="selector">
                <label>
                    <input type="checkbox" v-model="selectedCategories.proportions">
                    üìä Proporcje sk≈Çadnik√≥w
                </label>

                <label>
                    <input type="checkbox" v-model="selectedCategories.review">
                    üîç Review sk≈Çadnik√≥w
                </label>

                <label>
                    <input type="checkbox" v-model="selectedCategories.vodka">
                    üç∏ Wiedza o w√≥dkach
                </label>

                <label>
                    <input type="checkbox" v-model="selectedCategories.builder">
                    üîß Konstruktor drink√≥w
                </label>

                <!-- NOWA SEKCJA: Menu wyboru alkoholi dla konstruktora -->
                <div v-if="selectedCategories.builder" class="builder-alcohol-selection">
                    <h4 style="margin: 15px 0 10px 0; color: #667eea; font-size: 1rem;">Wybierz alkochole do ƒáwiczenia:</h4>
                    <div class="alcohol-selector">
                        <label v-for="alcohol in Object.keys(selectedBuilderAlcohols)" :key="alcohol">
                            <input 
                                type="checkbox" 
                                :checked="selectedBuilderAlcohols[alcohol]"
                                @change="toggleBuilderAlcohol(alcohol)"
                            >
                            {{ alcohol }}
                        </label>
                    </div>
                    <div v-if="!hasSelectedBuilderAlcohols" class="alcohol-warning">
                        ‚ö†Ô∏è Wybierz przynajmniej jeden alkohol dla konstruktora
                    </div>
                </div>
            </div>

            <button 
                :disabled="!hasSelectedCategories || (selectedCategories.builder && !hasSelectedBuilderAlcohols)" 
                @click="startQuiz()" 
                class="btn"
            >
                Rozpocznij Quiz
            </button>
        </div>

        <!-- Biblioteka Alkocholi -->
        <div v-if="currentScreen === 'library'" class="main-card">
            <button @click="goToStart()" class="btn-back">‚Üê Powr√≥t</button>
            <h2>üç∑ Biblioteka Alkocholi</h2>
            <p class="library-subtitle">Poznaj charakterystyki r√≥≈ºnych alkocholi</p>

            <div class="library-categories">
                <button 
                    v-for="category in libraryCategories" 
                    :key="category" 
                    @click="selectLibraryCategory(category)"
                    class="category-btn"
                    :class="{ active: selectedLibraryCategory === category }"
                >
                    {{ category }}
                </button>
            </div>

            <div class="library-content">
                <div v-for="alcohol in currentLibraryItems" :key="alcohol.name" class="alcohol-card">
                    <h3 class="alcohol-name">{{ alcohol.name }}</h3>
                    <p class="alcohol-description">{{ alcohol.description }}</p>
                </div>
            </div>
        </div>

        <!-- Biblioteka Drink√≥w -->
        <div v-if="currentScreen === 'drink-library'" class="main-card">
            <button @click="goToStart()" class="btn-back">‚Üê Powr√≥t</button>
            <h2>üç∏ Biblioteka Drink√≥w</h2>
            <p class="library-subtitle">Przepisy koktajli wed≈Çug alkocholi bazowych</p>

            <div class="library-categories">
                <button 
                    v-for="category in drinkCategories" 
                    :key="category" 
                    @click="selectDrinkCategory(category)"
                    class="category-btn"
                    :class="{ active: selectedDrinkCategory === category }"
                >
                    {{ category }}
                </button>
            </div>

            <div class="library-content">
                <div v-if="currentDrinkItems.length === 0" class="empty-category">
                    <p>Brak drink√≥w w tej kategorii</p>
                    <small>Przepisy bƒôdƒÖ dodane wkr√≥tce</small>
                </div>
                <div 
                    v-for="drink in currentDrinkItems" 
                    :key="drink.name" 
                    class="drink-card"
                    :class="{ hidden: isDrinkHidden(drink.name) }"
                    @click="toggleDrinkVisibility(drink.name)"
                >
                    <h3 class="drink-name">{{ drink.name }}</h3>
                    <div class="drink-details" :class="{ hidden: isDrinkHidden(drink.name) }">
                        <!-- NOWA SEKCJA: Szk≈Ço -->
                        <div v-if="drink.glass" class="drink-glass">
                            <h4>ü•É Szk≈Ço:</h4>
                            <p>{{ drink.glass }}</p>
                        </div>

                        <!-- Sk≈Çadniki -->
                        <div v-if="drink.ingredients" class="drink-ingredients">
                            <h4>üß™ Sk≈Çadniki:</h4>
                            <ul>
                                <li v-for="ingredient in drink.ingredients" :key="ingredient">{{ ingredient }}</li>
                            </ul>
                        </div>

                        <!-- NOWA SEKCJA: Metoda przygotowania -->
                        <div v-if="drink.method" class="drink-method">
                            <h4>‚öóÔ∏è Metoda:</h4>
                            <ol>
                                <li v-for="step in drink.method" :key="step">{{ step }}</li>
                            </ol>
                        </div>

                        <!-- Dekoracja -->
                        <div v-if="drink.decoration" class="drink-decoration">
                            <h4>üé® Dekoracja:</h4>
                            <p>{{ drink.decoration }}</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ekran quizu -->
        <div v-if="currentScreen === 'quiz'" class="main-card">
            <div class="progress-bar">
                <div class="progress" :style="{ width: progressWidth }"></div>
            </div>

            <p class="center">
                Pytanie {{ (currentQuestionIndex || 0) + 1 }} / {{ questions.length }}
            </p>

            <!-- Konstruktor drinka - Krok 1: Wyb√≥r sk≈Çadnik√≥w -->
            <div v-if="currentQuestion.type === 'builder' && builderStep === 1">
                <h3 class="center">üîß Konstruktor drinka - Krok 1/3</h3>
                <p class="builder-instruction">Wybierz sk≈Çadniki dla tego drinka:</p>
                <h4 class="center">{{ currentQuestion.drinkName }}</h4>

                <div class="builder-ingredients">
                    <div 
                        v-for="ingredient in currentQuestion.allIngredients" 
                        :key="ingredient"
                        class="ingredient-checkbox"
                        @click="toggleIngredient(ingredient)"
                    >
                        <input 
                            type="checkbox" 
                            :checked="selectedIngredients.has(ingredient)"
                            @change="toggleIngredient(ingredient)"
                        >
                        <span>{{ ingredient }}</span>
                    </div>
                </div>

                <p class="selected-count center">Wybrano: {{ selectedIngredientsCount }}</p>

                <div class="builder-actions">
                    <button @click="checkIngredients()" class="btn">Sprawd≈∫ sk≈Çadniki</button>
                </div>
            </div>

            <!-- Konstruktor drinka - Krok 2: Proporcje -->
            <div v-if="currentQuestion.type === 'builder' && builderStep === 2">
                <h3 class="center">üîß Konstruktor drinka - Krok 2/3</h3>
                <p class="builder-instruction">Wpisz proporcje dla wybranych sk≈Çadnik√≥w:</p>
                <h4 class="center">{{ currentQuestion.drinkName }}</h4>

                <div class="builder-proportions">
                    <div 
                        v-for="ingredient in Array.from(selectedIngredients)" 
                        :key="ingredient"
                        class="proportion-input"
                    >
                        <label>{{ ingredient }}:</label>
                        <input 
                            type="number" 
                            v-model="ingredientAmounts[ingredient]" 
                            min="0"
                            step="1"
                        >
                        <span>ml</span>
                    </div>
                </div>

                <div class="builder-actions">
                    <button @click="checkProportions()" class="btn">Sprawd≈∫ proporcje</button>
                </div>
            </div>

            <!-- Konstruktor drinka - Krok 3: Wyb√≥r szk≈Ça -->
            <div v-if="currentQuestion.type === 'builder' && builderStep === 3">
                <h3 class="center">üîß Konstruktor drinka - Krok 3/3</h3>
                <p class="builder-instruction">Wybierz odpowiednie szk≈Ço dla tego drinka:</p>
                <h4 class="center">{{ currentQuestion.drinkName }}</h4>

                <div class="builder-glasses">
                    <button 
                        v-for="glass in shuffledGlassOptions" 
                        :key="glass"
                        @click="selectGlass(glass)"
                        class="glass-btn"
                        :class="{ selected: selectedGlass === glass }"
                    >
                        ü•É {{ glass }}
                    </button>
                </div>

                <p class="selected-count center">Wybrane szk≈Ço: {{ selectedGlass }}</p>

                <div class="builder-actions">
                    <button @click="checkGlass()" class="btn" :disabled="!selectedGlass">Sprawd≈∫ szk≈Ço</button>
                </div>
            </div>

            <!-- Standardowe pytania -->
            <div v-if="currentQuestion.type !== 'builder'">
                <h3 class="center">{{ currentQuestion.question }}</h3>

                <!-- Pytania o proporcje -->
                <div v-if="currentQuestion.type === 'proportions'">
                    <h3 class="center">Wybierz poprawne proporcje dla:</h3>
                    <p class="center"><strong>{{ currentQuestion.correct }}</strong></p>

                    <div 
                        v-for="(option, idx) in shuffledAnswers" 
                        :key="idx"
                        class="recipe-option"
                        :class="getAnswerClass(idx)"
                        @click="answerQuestion(idx)"
                    >
                        <div v-for="ingredient in option" :key="ingredient.name" class="ingredient">
                            {{ ingredient.name }}: <strong>{{ ingredient.amount }} ml</strong>
                        </div>
                    </div>
                </div>

                <!-- Pytania Yes/No -->
                <div v-else class="yn-wrapper">
                    <button 
                        v-for="(answer, idx) in shuffledAnswers" 
                        :key="idx"
                        @click="answerQuestion(idx)" 
                        class="answer-btn yn-btn"
                        :class="getAnswerClass(idx)"
                        :disabled="answerSelected"
                    >
                        {{ answer }}
                    </button>
                </div>
            </div>

            <!-- Wy≈õwietlanie przepisu po odpowiedzi w review -->
            <div v-if="showRecipe" class="recipe-review-box">
                <h4>üìã Przepis: {{ currentQuestion.drinkName }}</h4>
                <ul>
                    <li v-for="ingredient in currentRecipe" :key="ingredient.name">
                        {{ ingredient.name }}
                        <strong>{{ ingredient.amount }} ml</strong>
                    </li>
                </ul>
            </div>

            <!-- Wy≈õwietlanie prawid≈Çowego przepisu w konstruktorze -->
            <div v-if="showBuilderRecipe" class="recipe-review-box">
                <h4>üìã Prawid≈Çowy przepis: {{ currentQuestion.drinkName }}</h4>

                <div class="correct-answer-section">
                    <h5>üß™ Sk≈Çadniki:</h5>
                    <ul>
                        <li v-for="ingredient in currentQuestion.correctRecipe" :key="ingredient.name">
                            {{ ingredient.name }}
                            <strong>{{ ingredient.amount }} ml</strong>
                        </li>
                    </ul>
                </div>

                <div class="correct-answer-section">
                    <h5>ü•É Szk≈Ço:</h5>
                    <p><strong>{{ currentQuestion.correctGlass }}</strong></p>
                </div>
            </div>

            <!-- Sukces w konstruktorze -->
            <div v-if="showDecorationSuccess" class="decoration-success-box">
                <h4>üéâ Gratulacje! Drink wykonany prawid≈Çowo!</h4>

                <div class="decoration-section">
                    <h5>üé® Dekoracja:</h5>
                    <p>{{ currentQuestion.decoration }}</p>
                </div>
            </div>
        </div>

        <!-- Ekran wynik√≥w -->
        <div v-if="currentScreen === 'result'" class="main-card">
            <h2 class="center">üéâ Wyniki</h2>
            <div class="center">
                <div class="score">{{ score }} / {{ questions.length }}</div>
                <div class="percentage">{{ Math.round((score/questions.length)*100) }}%</div>
                <button @click="restartQuiz()" class="btn">Pon√≥w Quiz</button>
            </div>
        </div>
    </div>

    <script src="app.js" type="module"></script>
</body>
</html>
