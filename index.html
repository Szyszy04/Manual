<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quiz Barma≈Ñski z Bibliotekami</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body>
  <div id="app">
    <!-- Ekran startowy -->
    <div v-if="currentScreen === 'start'" class="main-card center">
      <h2>üçπ Quiz Barma≈Ñski</h2>
      <p>Wybierz opcjƒô:</p>

      <!-- Przyciski nawigacji g≈Ç√≥wnej -->
      <div class="main-navigation">
        <button class="btn main-nav-btn" @click="currentScreen = 'quiz-setup'">
          üéØ Rozpocznij Quiz
        </button>
        <button class="btn main-nav-btn library-btn" @click="goToLibrary">
          üìñ Biblioteka Alkoholi
        </button>
        <button class="btn main-nav-btn drinks-btn" @click="goToDrinkLibrary">
          üç∏ Biblioteka Drink√≥w
        </button>
      </div>
    </div>

    <!-- Ekran wyboru kategorii quizu -->
    <div v-if="currentScreen === 'quiz-setup'" class="main-card center">
      <button class="btn btn-back" @click="goToStart">‚Üê Powr√≥t</button>

      <h2>üçπ Quiz Barma≈Ñski</h2>
      <p>Wybierz kategorie pyta≈Ñ:</p>

      <div class="selector">
        <label><input type="checkbox" v-model="selectedCategories.proportions"> ‚öñÔ∏è Proporcje sk≈Çadnik√≥w</label>
        <label><input type="checkbox" v-model="selectedCategories.review"> üîÑ Powt√≥rka sk≈Çadnik√≥w TAK/NIE</label>
        <label><input type="checkbox" v-model="selectedCategories.vodka"> ü•É W√≥dki (cena/surowiec)</label>
        <label><input type="checkbox" v-model="selectedCategories.spirits"> ü•Ç Alkohole (profil smakowy/pochodzenie)</label>
        <label><input type="checkbox" v-model="selectedCategories.builder"> üîß Konstruktor drinka (buduj przepis)</label>
      </div>

      <button class="btn" @click="startQuiz" :disabled="!hasSelectedCategories">
        Rozpocznij Quiz
      </button>
    </div>

    <!-- Ekran biblioteki alkocholi -->
    <div v-if="currentScreen === 'library'" class="main-card">
      <button class="btn btn-back" @click="goToStart">‚Üê Powr√≥t do menu g≈Ç√≥wnego</button>

      <h2 class="center">üìñ Biblioteka Alkoholi</h2>
      <p class="center library-subtitle">Poznaj charakterystyki r√≥≈ºnych alkoholi</p>

      <!-- Kategorie -->
      <div class="library-categories">
        <button v-for="category in libraryCategories"
                :key="category"
                class="category-btn"
                :class="{ active: selectedLibraryCategory === category }"
                @click="selectLibraryCategory(category)">
          {{ category }}
        </button>
      </div>

      <!-- Karty alkoholi -->
      <div class="library-content">
        <div v-for="alcohol in currentLibraryItems" 
             :key="alcohol.name" 
             class="alcohol-card">
          <h3 class="alcohol-name">{{ alcohol.name }}</h3>
          <p class="alcohol-description">{{ alcohol.description }}</p>
        </div>
      </div>
    </div>

    <!-- Ekran biblioteki drink√≥w -->
    <div v-if="currentScreen === 'drink-library'" class="main-card">
      <button class="btn btn-back" @click="goToStart">‚Üê Powr√≥t do menu g≈Ç√≥wnego</button>

      <h2 class="center">üç∏ Biblioteka Drink√≥w</h2>
      <p class="center library-subtitle">Przepisy koktajli wed≈Çug alkoholi bazowych</p>

      <!-- Kategorie drink√≥w -->
      <div class="library-categories">
        <button v-for="category in drinkCategories"
                :key="category"
                class="category-btn"
                :class="{ active: selectedDrinkCategory === category }"
                @click="selectDrinkCategory(category)">
          {{ category }}
        </button>
      </div>

      <!-- Karty drink√≥w -->
      <div class="library-content">
        <div v-for="drink in currentDrinkItems" 
             :key="drink.name" 
             class="drink-card"
             :class="{ hidden: isDrinkHidden(drink.name) }"
             @click="toggleDrinkVisibility(drink.name)">
          <h3 class="drink-name">{{ drink.name }}</h3>

          <!-- Sk≈Çadniki - ukrywane/pokazywane -->
          <div class="drink-details" :class="{ hidden: isDrinkHidden(drink.name) }">
            <div class="drink-ingredients">
              <h4>Sk≈Çadniki:</h4>
              <ul>
                <li v-for="ingredient in drink.ingredients" :key="ingredient">
                  {{ ingredient }}
                </li>
              </ul>
            </div>

            <div class="drink-decoration">
              <h4>Dekoracja:</h4>
              <p>{{ drink.decoration }}</p>
            </div>
          </div>
        </div>

        <!-- Info gdy kategoria pusta -->
        <div v-if="currentDrinkItems.length === 0" class="empty-category">
          <p>Brak drink√≥w w tej kategorii</p>
          <small>Przepisy bƒôdƒÖ dodane wkr√≥tce</small>
        </div>
      </div>
    </div>

    <!-- Ekran quizu -->
    <div v-if="currentScreen === 'quiz'" class="main-card">
      <div class="progress-bar">
        <div class="progress" :style="{ width: progressWidth }"></div>
      </div>

      <!-- Pytania o proporcje -->
      <div v-if="currentQuestion.type === 'proportions'">
        <h3 class="center">Jakie sƒÖ proporcje w {{ currentQuestion.correct }}?</h3>

        <div v-for="(recipe, idx) in shuffledAnswers"
             :key="idx"
             class="recipe-option"
             :class="getAnswerClass(idx)"
             @click="answerQuestion(idx)">
          <div v-for="ingredient in recipe" :key="ingredient.name" class="ingredient">
            {{ ingredient.amount }}ml {{ ingredient.name }}
          </div>
        </div>
      </div>

      <!-- Pytania powt√≥rkowe TAK/NIE -->
      <div v-else-if="currentQuestion.type === 'review'">
        <div class="center">üç∏</div>
        <h3 class="center">{{ currentQuestion.question }}</h3>

        <div class="yn-wrapper">
          <button class="answer-btn yn-btn" 
                  :class="getAnswerClass(0)" 
                  @click="answerQuestion(0)" 
                  :disabled="answerSelected">
            TAK
          </button>
          <button class="answer-btn yn-btn" 
                  :class="getAnswerClass(1)" 
                  @click="answerQuestion(1)" 
                  :disabled="answerSelected">
            NIE
          </button>
        </div>

        <!-- Wy≈õwietlanie przepisu po odpowiedzi -->
        <div v-if="showRecipe && currentRecipe.length > 0" class="recipe-review-box">
          <h4>üìã Przepis na {{ currentQuestion.drinkName }}:</h4>
          <ul>
            <li v-for="skladnik in currentRecipe" :key="skladnik.name">
              <strong>{{ skladnik.amount }}ml</strong> {{ skladnik.name }}
            </li>
          </ul>
        </div>
      </div>

      <!-- Pytania o w√≥dki -->
      <div v-else-if="currentQuestion.type === 'vodka'">
        <div class="center">ü•É</div>
        <h3 class="center">{{ currentQuestion.question }}</h3>

        <div class="yn-wrapper">
          <button class="answer-btn yn-btn" 
                  :class="getAnswerClass(0)" 
                  @click="answerQuestion(0)" 
                  :disabled="answerSelected">
            {{ currentQuestion.answers[0] }}
          </button>
          <button class="answer-btn yn-btn" 
                  :class="getAnswerClass(1)" 
                  @click="answerQuestion(1)" 
                  :disabled="answerSelected">
            {{ currentQuestion.answers[1] }}
          </button>
        </div>
      </div>

      <!-- Pytania o alkochole -->
      <div v-else-if="currentQuestion.type === 'spirits'">
        <div class="center">ü•Ç</div>
        <h3 class="center">{{ currentQuestion.question }}</h3>

        <button v-for="(answer, idx) in shuffledAnswers"
                :key="idx"
                class="answer-btn"
                :class="getAnswerClass(idx)"
                @click="answerQuestion(idx)"
                :disabled="answerSelected">
          {{ answer }}
        </button>
      </div>

      <!-- Konstruktor drinka -->
      <div v-else-if="currentQuestion.type === 'builder'">
        <div class="center">üîß</div>
        <h3 class="center">Zbuduj {{ currentQuestion.drinkName }}</h3>

        <!-- ETAP 1: Wyb√≥r sk≈Çadnik√≥w -->
        <div v-if="builderStep === 1">
          <p class="builder-instruction">Wybierz sk≈Çadniki dla tego drinka:</p>
          <div class="builder-ingredients">
            <label v-for="ingredient in currentQuestion.allIngredients" 
                   :key="ingredient" 
                   class="ingredient-checkbox">
              <input type="checkbox" 
                     :checked="selectedIngredients.has(ingredient)"
                     @change="toggleIngredient(ingredient)">
              <span>{{ ingredient }}</span>
            </label>
          </div>
          <div class="builder-actions">
            <p class="selected-count">Wybrano: {{ selectedIngredientsCount }}</p>
            <button class="btn" @click="checkIngredients" :disabled="selectedIngredientsCount === 0">
              Zatwierd≈∫ sk≈Çadniki
            </button>
          </div>
        </div>

        <!-- ETAP 2: Wpisywanie proporcji -->
        <div v-if="builderStep === 2">
          <p class="builder-instruction">Wpisz proporcje dla wybranych sk≈Çadnik√≥w:</p>
          <div class="builder-proportions">
            <div v-for="ingredient in Array.from(selectedIngredients)" 
                 :key="ingredient" 
                 class="proportion-input">
              <label>{{ ingredient }}:</label>
              <input type="number" 
                     v-model="ingredientAmounts[ingredient]" 
                     placeholder="ml"
                     min="1"
                     max="200">
              <span>ml</span>
            </div>
          </div>
          <div class="builder-actions">
            <button class="btn" @click="checkProportions">
              Zatwierd≈∫ proporcje
            </button>
          </div>
        </div>

        <!-- Wy≈õwietlanie przepisu po b≈Çƒôdnej odpowiedzi -->
        <div v-if="showBuilderRecipe" class="recipe-review-box">
          <h4>üìã Poprawny przepis na {{ currentQuestion.drinkName }}:</h4>
          <ul>
            <li v-for="skladnik in currentQuestion.correctRecipe" :key="skladnik.name">
              <strong>{{ skladnik.amount }}ml</strong> {{ skladnik.name }}
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Ekran wynik√≥w -->
    <div v-if="currentScreen === 'result'" class="main-card center">
      <h2>Tw√≥j wynik</h2>
      <p class="score">{{ score }} / {{ questions.length }}</p>
      <p class="percentage">{{ Math.round((score/questions.length)*100) }}%</p>
      <button class="btn" @click="restartQuiz">Zagraj ponownie</button>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
